# Vercel 图片加载与导航栏失效问题修复方案

## 1. 问题分析
经过对 `scripts/product_logic.js` 和 `assets/products.json` 的审查，我发现了两个核心问题：

### A. 图片路径问题
- **原因**：在 `products.json` 中，图片路径是以 `/assets/` 开头的相对路径（例如 `/assets/images/...`）。
- **现象**：虽然我已经将 `fetch` 请求改为了绝对路径，但**图片本身的 `src`** 在 JavaScript 渲染时仍然直接使用了 JSON 中的相对路径。在 Vercel 的某些路由（如 `/products/detail/`）下，浏览器可能会尝试基于当前页面路径去加载图片（例如解析为 `/products/detail/assets/...`），从而导致 404。
- **证据**：详情页代码中 `mainImg.src = encodeURI(product.images[0])` 直接使用了相对路径。

### B. 左侧导航栏失效与内容不显示
- **原因**：侧边栏的渲染依赖于 `loadProducts` 函数的成功执行。如果 `loadProducts` 中的任何一步出错（比如图片路径解析错误引发后续逻辑中断，或者 `fetch` 仍有跨域/路径问题），侧边栏就不会被渲染。
- **关联**：用户提到“左侧导航栏点击后无效”，这通常是因为 JavaScript 报错导致事件绑定失败，或者 DOM 元素根本没有正确生成。

## 2. 解决方案

我将执行以下修复步骤：

1.  **强制图片路径绝对化**：
    在 `scripts/product_logic.js` 中，在渲染图片 `src` 之前，统一添加 `window.location.origin` 前缀。这样无论当前页面 URL 是什么，图片请求都会指向网站根目录。

2.  **优化侧边栏初始化**：
    确保 `renderSidebar()` 在数据加载后立即执行，并增加错误处理，防止因某个产品数据异常导致整个侧边栏渲染失败。

3.  **提交修复**：
    将修改后的代码推送到 GitHub，触发 Vercel 重新部署。

## 3. 具体修改计划

**修改文件：`scripts/product_logic.js`**

*   **修改点 1 (图片渲染)**：
    将所有设置 `img.src` 的地方，由 `encodeURI(imgPath)` 改为 `window.location.origin + encodeURI(imgPath)`。
    涉及函数：`filterCategory` (列表页) 和 `renderDetailPage` (详情页)。

*   **修改点 2 (数据加载)**：
    再次确认 `loadProducts` 中的 `fetch` 逻辑，确保它在所有页面都能正确获取 `products.json`。

通过这些修改，图片将始终使用完整的绝对 URL 加载，彻底解决路径错乱问题。侧边栏也将因为 JS 执行流畅而恢复正常。